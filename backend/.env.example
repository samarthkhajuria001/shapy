# ===========================================
# Shapy Backend Configuration
# Copy this file to .env and fill in your values
# ===========================================

# Application
APP_NAME=Shapy
APP_VERSION=1.0.0
DEBUG=false
ENVIRONMENT=development

# Server
HOST=0.0.0.0
PORT=8000

# Database (SQLite for local, PostgreSQL for production)
DATABASE_URL=sqlite+aiosqlite:///./shapy.db

# Redis (required for session state)
REDIS_URL=redis://localhost:6379/0

# JWT Authentication (CHANGE IN PRODUCTION!)
JWT_SECRET_KEY=change-this-to-a-secure-random-string
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7

# OpenAI API (REQUIRED)
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4o
OPENAI_EMBEDDING_MODEL=text-embedding-3-small

# CORS Origins (JSON array format)
CORS_ORIGINS=["http://localhost:4200","http://localhost:3000"]

# ===========================================
# Indexing Settings (for document ingestion)
# ===========================================
CHROMA_PATH=./data/chroma
CHROMA_COLLECTION=documents
ENRICHMENT_MODEL=gpt-4o
ENRICHMENT_BATCH_SIZE=10
ENRICHMENT_MAX_CONCURRENT=5
VISION_MODEL=gpt-4o

# Chunking Settings
CHUNK_TARGET_SIZE=600
CHUNK_MIN_SIZE=200
CHUNK_MAX_SIZE=1000
CHUNK_OVERLAP=100
PARENT_SOFT_LIMIT_TOKENS=600

# ===========================================
# Retrieval Settings
# ===========================================
RETRIEVAL_TOP_K_PER_QUERY=8
RETRIEVAL_TOP_N_PARENTS=3
RETRIEVAL_RRF_K=60
ENABLE_QUERY_EXPANSION=true
ENABLE_BM25=true
ENABLE_XREF_EXPANSION=true

# ===========================================
# Session Management
# ===========================================
SESSION_TTL_HOURS=24
MAX_SESSIONS_PER_USER=3
MAX_OBJECTS_PER_CONTEXT=100
MAX_POINTS_PER_POLYLINE=500
MAX_LAYERS_PER_CONTEXT=25
MAX_CONTEXT_SIZE_KB=2048
CONTEXT_SIZE_WARNING_KB=500

# ===========================================
# Agent Settings
# ===========================================
AGENT_MODEL=gpt-4o
AGENT_TEMPERATURE=0.1
AGENT_MAX_TOKENS=2000
AGENT_CLASSIFIER_MODEL=gpt-4o-mini
AGENT_CLARIFIER_MODEL=gpt-4o-mini
AGENT_MAX_CLARIFICATION_ROUNDS=3
AGENT_CONTEXT_TOKEN_BUDGET=4000
AGENT_ENABLE_ASSUMPTIONS=true
AGENT_ENABLE_CLARIFICATIONS=true
